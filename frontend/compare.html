<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lawn Depot - More</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@200..800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
  <style>
        .hidden {
            display: none;
        }
  </style>
</head>

<body>

  <nav>
    <a href="/" class="logo">
      <img src="./assets/Logo.png" alt="Logo">
    </a>

    <ul>
      <li><a href="/">Home</a></li>
      <li><a href="/products">Products</a></li>
      <li><a href="/cart">Cart</a></li>
      <li><a href="/about">About Us</a></li>
      <li><a href="/contact">Contact</a></li>
    </ul>

    <div class="user-icon" id="userIcon"><img src="./assets/User Icon.png" alt="User Icon"></div>

    <div class="user-menu" id="userMenu">
      <ul>
        <li><a href="/accountinfo">Account Information</a></li>
        <li><a href="/orderhistory">Order History</a></li>
        <li><a href="/logout">Logout</a></li>
      </ul>
    </div>
  </nav>

  <div class="content" id="content">
      <div class="search-container">
        <button class="search-button" id="search-button-one"><img src="./assets/Search Icon.png" alt="Search"></button>
        <input type="text" class="search-input" id="search-input-one" placeholder="Search Products...">
      </div>

      <div id="product-one" class="product-card"></div>
      <div class="search-container">
        <button class="search-button" id="search-button-two"><img src="./assets/Search Icon.png" alt="Search"></button>
        <input type="text" class="search-input" id="search-input-two" placeholder="Search Products...">
      </div>

      <div id="product-two" class="product-card"></div>
      <div id="reviews" class="review-container"></div>
    </div>
    <script>

      document.addEventListener('DOMContentLoaded', function () {
          // Toggle user menu
          const userIcon = document.getElementById('userIcon');
          const userMenu = document.getElementById('userMenu');
      
          userIcon.addEventListener('click', function () {
              userMenu.classList.toggle('show');
          })
        searchButton1 = document.getElementById("search-button-one")
        searchinput1 = document.getElementById("search-input-one")
        searchButton1.addEventListener("click", function(){
          console.log(searchinput1.value)
          if(searchinput1.value){
          getItem("product-one", searchinput1.value)
          }
        })
        searchButton2 = document.getElementById("search-button-two")
        searchinput2 = document.getElementById("search-input-two")
        searchButton2.addEventListener("click", function(){
          console.log(searchinput2.value)
          if(searchinput2.value){
          getItem("product-two", searchinput2.value)
          }
        })
        });

      function getItem(item_index, query){
          const productCard = document.getElementById(item_index);
          while (productCard.firstChild) {
            productCard.removeChild(productCard.firstChild);
          }
          fetch(`/search?q=${query}`)
              .then(response => response.json())
              .then(data => data[0])
              .then(item => {
                  const title = document.createElement('div');
                  title.classList.add('product-title');
                  title.textContent = item.name;
                  productCard.appendChild(title);
                  productName = item.name
      
                  const price = document.createElement('div');
                  price.classList.add('product-price');
                  price.textContent = `${item.price}`;
                  productCard.appendChild(price);
      
                  const description = document.createElement('div');
                  description.textContent = item.description;
                  productCard.appendChild(description);
      
                  const image = document.createElement('img');
                  image.src = item.image_url;
                  image.classList.add('product-image');
                  productCard.appendChild(image);
      
                  const cartButton = document.createElement('button');
                  cartButton.textContent = "add to cart";
                  cartButton.addEventListener('click', function() {
                      const body = { itemid: `${item.id}` };
                      fetch("/cart", {
                          method: 'POST',
                          headers: {
                              'Content-Type': 'application/json'
                          },
                          body: JSON.stringify(body)
                      });
                  });
                  productCard.appendChild(cartButton);
                  const productPrices = document.querySelectorAll(".product-price")
            console.log(productPrices)
                if (productPrices.length === 2) {
                    const newPara = document.createElement("p")
                    const content = document.getElementById("content")
                    // Get the prices from the text content of each <p> element
                    var price1 = parseFloat(productPrices[0].textContent.replace(/\D/g, ''));
                    var price2 = parseFloat(productPrices[1].textContent.replace(/\D/g, ''));

                    // Output which one is cheaper
                    if (price1 < price2) {
                        newPara.textContent = `The first product is cheaper by ${(price2 - price1)}`
                        
                    } else if (price2 < price1) {
                        newPara.textContent = `The second product is cheaper by ${(price1 - price2)}`
                    } else {
                        newPara.textContent = "Both products are priced the same."
                    }
                    content.appendChild(newPara)
                } 
              })
              .catch(error => {
                  console.error('Error fetching product details:', error);
              });

      }
      </script>
      



</body>

</html>
